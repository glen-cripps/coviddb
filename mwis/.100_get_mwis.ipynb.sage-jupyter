{"kernelspec":{"display_name":"Python 2 (system-wide)","language":"python","name":"python2"},"language_info":{"codemirror_mode":{"name":"ipython","version":2},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython2","version":"2.7.17"}}
{"cell_type":"code","execution_count":4,"metadata":{"trusted":true},"outputs":[{"name":"stderr","output_type":"stream","text":"/usr/lib/python2.7/dist-packages/requests/__init__.py:80: RequestsDependencyWarning: urllib3 (1.22) or chardet (2.3.0) doesn't match a supported version!\n  RequestsDependencyWarning)\n"}],"source":"import requests \nimport pandas as pd \nfrom bs4 import BeautifulSoup\n\nimport arrow\ntoday_dt = arrow.now().format('YYYYMMDD')"}
{"cell_type":"code","execution_count":83,"metadata":{"trusted":true},"outputs":[{"data":{"text/html":"smc-blob::4abb00c6-f947-464e-9e1a-2e725c8e4bfa","text/plain":"smc-blob::422b1b7d-ed39-4ec3-9f41-bb5fec902e2c"},"execution_count":83,"metadata":{},"output_type":"execute_result"}],"source":"yahoo_tickers=[]\nnames=[]\nprices=[]\nprice_changes=[]\nprice_changes_pct=[]\nvolumes = []\n\nCryptoCurrenciesUrl = \"https://www.finance.yahoo.com/world-indices\"\nr= requests.get(CryptoCurrenciesUrl)\ndata=r.text\nsoup=BeautifulSoup(data)\n\nfor i in range(46, 641, 17):\n    for listing in soup.find_all('tr', attrs={'data-reactid':i}):\n        for yahoo_ticker in listing.find_all('td', attrs={'data-reactid':i+1}):\n            yahoo_tickers.append(yahoo_ticker.text)\n        for name in listing.find_all('td', attrs={'data-reactid':i+3}):\n            names.append(name.text)\n        for price in listing.find_all('td', attrs={'data-reactid':i+4}):\n            prices.append(price.text)\n        for price_change in listing.find_all('td', attrs={'data-reactid':i+5}):\n            price_changes.append(price_change.text)\n        for price_change_pct in listing.find_all('td', attrs={'data-reactid':i+7}):\n            price_changes_pct.append(price_change_pct.text)\n        for volume in listing.find_all('td', attrs={'data-reactid':i+9}):\n            volumes.append(volume.text)\n        \n\n#for i in range(46, 47, 14):\n\ndf = pd.DataFrame({\"yahoo_ticker\":yahoo_tickers, \"names\": names, \"price\": prices, \"price_change\": price_changes, \"price_change_pct\":price_changes_pct, \"volume\":volumes })\ndf"}
{"cell_type":"code","execution_count":85,"metadata":{"trusted":true},"outputs":[],"source":"df.to_parquet(\"mwis.\" + today_dt + \".parquet\", compression='GZIP')\n"}